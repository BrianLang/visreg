<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  

  <title>visreg</title>
  <meta name="description" content="visreg: An R package for the visualization of regression models">
  
  <link rel="stylesheet" href="css/main.css">
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet">
  <script type="text/javascript" src="js/mathjax.config.js"></script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

</head>


  <body>

    <header>
  <div id="site-wrapper">
    <a id="site-title" href="index.html">visreg</a>
    <span class="version"> 2.7.0.1 </span>
    <div id="site-description">
      An R package for the visualization of regression models
    </div>
  </div>
</header>


    <div id="wrapper">
      <div id="sideBar">
  
  <ul> <h3>Basic framework</h3>
    <li><a href="basic.html">Getting started</a></li>
    <li><a href="contrast.html">Conditional vs. contrast plots</a></li>
    <li><a href="trans.html">Transformations</a></li>
    <li><a href="cond.html">Conditioning</a></li>
    <li><a href="options.html">Graphical options</a></li>
    <li><a href="gg.html">Visreg and ggplot2</a></li>
  </ul>

  <ul> <h3>Models with interactions</h3>
    <li><a href="cross.html">Cross-sectional plots</a></li>
    <li><a href="overlay.html">Overlay plots</a></li>
    <li><a href="surface.html">Surface plots</a></li>
  </ul>
  
  <ul> <h3>Special topics</h3>
    <li><a href="glm.html">GLMs</a></li>
    <li><a href="blackbox.html">Forests, SVMs, etc.</a></li>
    <li><a href="mixed.html">Mixed models</a></li>
    <li><a href="multi.html">Multiple outcomes</a></li>
    <li><a href="faq.html">FAQ</a></li>
  </ul>
</div>

      <div id="content">
        <p>As noted in <a href="basic.html">getting started</a>, the default behavior of <code class="highlighter-rouge">visreg</code> when constructing a conditional plot is to fill in the other variables with either the median (for continuous variables) or the most common category (for categorical variables).  This can be modified using the <code class="highlighter-rouge">cond</code> argument, which offers more explicit control over what to condition on.  Note that this has no bearing on contrast plots (at least, in the absence of interactions), which do not depend on the other terms in the model.</p>

<p>The <code class="highlighter-rouge">cond</code> argument must be provided as a named list.  Each element of that list specifies the value for one of the terms in the model; any elements left unspecified are filled in with the median/most common category.  For example, letâ€™s construct the a plot of wind vs. ozone, but condition on three different values for temperature: (1) a cold temperature of 50 degrees (2) the default median temperature of 79 degrees and (3) a hot temperature of 100 degrees.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">Ozone</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Solar.R</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Wind</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Temp</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">airquality</span><span class="p">)</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">))</span><span class="w">
</span><span class="n">visreg</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="s2">"Wind"</span><span class="p">,</span><span class="w"> </span><span class="n">cond</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">Temp</span><span class="o">=</span><span class="m">50</span><span class="p">))</span><span class="w">
</span><span class="n">visreg</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="s2">"Wind"</span><span class="p">)</span><span class="w">
</span><span class="n">visreg</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="s2">"Wind"</span><span class="p">,</span><span class="w"> </span><span class="n">cond</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">Temp</span><span class="o">=</span><span class="m">100</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p><img src="img/cond-wind_temp-1.png" title="plot of chunk wind_temp" alt="plot of chunk wind_temp" width="100%" /></p>

<p>A few observations/remarks:</p>

<ul>
  <li>The values on the vertical axis differ; as we condition on higher temperatures, the expected ozone concentration goes up since the regression coefficient for temperature is positive</li>
  <li>The slope of the line, the distance from the line to each residual, and the range of the residuals is the same in all three plots; conditioning on different values of temperature merely adds a constant to the regression line and the partial residuals.</li>
  <li>The width of the confidence band <em>does</em> change, however: the data set has few observations at very high and very low temperatures, so the standard errors are much larger for the plots on the right and left than for the plot in the middle.</li>
  <li>The shape of the confidence band also changes.  In the middle plot, the confidence band is narrowest in the middle and wider at the ends.  In the left plot (conditioning on low temperature), however, the confidence band is narrowest for high wind levels.  This arises because there is a negative correlation between wind and temperature ($\hat{\rho}$=-0.46), and thus, more cold windy days in the data set than cold calm days.  The opposite phenomenon happens in the right plot, where the relative absence of hot windy days causes the confidence band to be wider for high winds than for low winds.</li>
</ul>

<p>Finally, recall that this model had three explanatory variables; in the above example, <code class="highlighter-rouge">visreg</code> calculated the conditional response by filling in solar radiation with its median value, as it was not specified otherwise in the <code class="highlighter-rouge">cond</code> argument.</p>

      </div>
    </div>

    <footer id="site-footer">

  <div>

    by <a href="http://myweb.uiowa.edu/pbreheny">Patrick Breheny</a>
    <div id="last-updated">
      Last updated: 14 Aug 2020
      <a href="https://github.com/pbreheny/visreg">
        <span class="icon  icon--github">
          <svg viewBox="0 0 16 16">
            <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
          </svg>
        </span>
      </a>
    </div>
  </div>
  
</footer>


  </body>

</html>
